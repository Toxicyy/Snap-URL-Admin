"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[245],{71245:function(e,t,a){a.d(t,{H:function(){return l},a:function(){return i}});var o=a(57437),r=a(2265),n=a(99376),s=a(71837);let c=(0,r.createContext)(void 0),l=e=>{let{children:t}=e,[a,l]=(0,r.useState)(null),[i,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(!0),[g,p]=(0,r.useState)(null),y=(0,n.useRouter)();(0,r.useEffect)(()=>{(async()=>{console.log("AuthContext: Starting auth check...");try{var e;let t=localStorage.getItem("authToken");if(console.log("AuthContext: Token found:",!!t),!t){console.log("AuthContext: No token, setting loading to false"),h(!1);return}console.log("AuthContext: Validating token with API...");let a=await s.ZP.auth.validate();a.success&&(null===(e=a.data)||void 0===e?void 0:e.user)?(console.log("AuthContext: Token valid, setting user data"),l(a.data.user),u(!0)):(console.log("AuthContext: Token validation failed"),localStorage.removeItem("authToken"),p("Session expired. Please login again."))}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("authToken"),e instanceof Error&&!e.message.includes("401")&&p("Authentication check failed. Please try again.")}finally{console.log("AuthContext: Setting loading to false"),h(!1)}})()},[]);let f=async e=>{h(!0),p(null);try{console.log("AuthContext: Attempting login...");let t=await s.ZP.auth.login(e);if(t.success&&t.data){let{user:e,token:a}=t.data;return localStorage.setItem("authToken",a),l(e),u(!0),console.log("AuthContext: Login successful, redirecting to dashboard"),y.push("/dashboard"),t}throw Error(t.message||"Login failed")}catch(t){let e=t instanceof Error?t.message:"Login failed. Please check your credentials.";return console.error("Login failed:",t),p(e),{success:!1,error:e,message:e}}finally{h(!1)}},m=async e=>{h(!0),p(null);try{console.log("AuthContext: Attempting registration...");let{name:t,email:a,password:o}=e,r=await s.ZP.auth.register({name:t,email:a,password:o});if(r.success&&r.data){let{user:e,token:t}=r.data;return localStorage.setItem("authToken",t),l(e),u(!0),console.log("AuthContext: Registration successful, redirecting to dashboard"),y.push("/dashboard"),r}throw Error(r.message||"Registration failed")}catch(t){let e=t instanceof Error?t.message:"Registration failed. Please try again.";return console.error("Registration failed:",t),p(e),{success:!1,error:e,message:e}}finally{h(!1)}},S=async()=>{try{await s.ZP.auth.logout()}catch(e){console.error("Logout API call failed, but continuing with client-side logout:",e)}finally{localStorage.removeItem("authToken"),l(null),u(!1),p(null),y.push("/auth/login")}},P=async e=>{h(!0),p(null);try{var t;console.log("AuthContext: Updating profile...");let a=await s.ZP.auth.updateProfile(e);if(a.success&&(null===(t=a.data)||void 0===t?void 0:t.user))return l(a.data.user),{success:!0,message:a.message||"Profile updated successfully"};throw Error(a.message||"Profile update failed")}catch(t){let e=t instanceof Error?t.message:"Profile update failed";return console.error("Profile update failed:",t),p(e),{success:!1,error:e,message:e}}finally{h(!1)}},w=async e=>{h(!0),p(null);try{console.log("AuthContext: Changing password...");let t=await s.ZP.auth.changePassword(e);if(t.success)return{success:!0,message:t.message||"Password changed successfully"};throw Error(t.message||"Password change failed")}catch(t){let e=t instanceof Error?t.message:"Password change failed";return console.error("Password change failed:",t),p(e),{success:!1,error:e,message:e}}finally{h(!1)}},b=async()=>{if(i)try{var e;console.log("AuthContext: Refreshing user data...");let t=await s.ZP.auth.getProfile();t.success&&(null===(e=t.data)||void 0===e?void 0:e.user)&&l(t.data.user)}catch(e){console.error("Failed to refresh user data:",e),e instanceof Error&&e.message.includes("401")&&(localStorage.removeItem("authToken"),l(null),u(!1),p("Session expired. Please login again."),y.push("/auth/login"))}};return(0,o.jsx)(c.Provider,{value:{user:a,isAuthenticated:i,loading:d,error:g,login:f,register:m,logout:S,updateProfile:P,changePassword:w,clearError:()=>{p(null)},refreshUser:b},children:t})},i=()=>{let e=(0,r.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},71837:function(e,t,a){var o=a(85583),r=a(1780);let n="https://snap-url-api-production.up.railway.app",s=()=>localStorage.getItem("authToken"),c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:a="GET",body:c,headers:l={},skipAuth:i=!1}=t,u={method:a,headers:(0,o._)({"Content-Type":"application/json"},l)};if(!i){let e=s();e&&(u.headers=(0,r._)((0,o._)({},u.headers),{Authorization:"Bearer ".concat(e)}))}c&&"GET"!==a&&(u.body=JSON.stringify(c));try{let t;let a=await fetch("".concat(n).concat(e),u),o=a.headers.get("content-type");if(null==o?void 0:o.includes("application/json"))t=await a.json();else if(null==o?void 0:o.includes("text/")){let e=await a.text();t={success:a.ok,message:e,data:e}}else{let e=await a.blob();t={success:a.ok,data:e}}if(!a.ok)throw Error(t.message||t.error||"HTTP ".concat(a.status));return t}catch(t){throw console.error("API Error [".concat(a," ").concat(e,"]:"),t),t}};t.ZP={auth:{register:async e=>{let t=await c("/api/auth/register",{method:"POST",body:e,skipAuth:!0});return t.success?{success:!0,message:t.message,data:t.data}:{success:!1,message:t.message,error:t.error}},login:async e=>{let t=await c("/api/auth/login",{method:"POST",body:e,skipAuth:!0});return t.success?{success:!0,message:t.message,data:t.data}:{success:!1,message:t.message,error:t.error}},refresh:async()=>c("/api/auth/refresh",{method:"POST"}),logout:async()=>c("/api/auth/logout",{method:"POST"}),validate:async()=>c("/api/auth/validate"),getProfile:async()=>c("/api/auth/profile"),updateProfile:async e=>c("/api/auth/profile",{method:"PUT",body:e}),changePassword:async e=>c("/api/auth/change-password",{method:"PUT",body:e}),forgotPassword:async e=>c("/api/auth/forgot-password",{method:"POST",body:{email:e},skipAuth:!0}),resetPassword:async(e,t)=>c("/api/auth/reset-password",{method:"POST",body:{resetToken:e,newPassword:t},skipAuth:!0}),getApiUsage:async()=>c("/api/auth/usage"),generateApiKey:async e=>c("/api/auth/api-key",{method:"POST",body:e?{keyName:e}:{}}),deactivateAccount:async e=>c("/api/auth/account",{method:"DELETE",body:e?{reason:e}:{}})},urls:{create:async e=>c("/api/urls",{method:"POST",body:e,skipAuth:!1}),getAll:async e=>{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,o]=e;null!=o&&t.append(a,String(o))}),c("/api/urls".concat(t.toString()?"?".concat(t.toString()):""))},search:async(e,t)=>{let a=new URLSearchParams({q:e});return t&&Object.entries(t).forEach(e=>{let[t,o]=e;null!=o&&a.append(t,String(o))}),c("/api/urls/search?".concat(a.toString()))},getPopular:async e=>{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,o]=e;null!=o&&t.append(a,String(o))}),c("/api/urls/popular".concat(t.toString()?"?".concat(t.toString()):""))},export:async e=>{let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[a,o]=e;null!=o&&t.append(a,String(o))});let a="/api/urls/export".concat(t.toString()?"?".concat(t.toString()):"");try{let e=s(),t=await fetch("".concat(n).concat(a),{headers:e?{Authorization:"Bearer ".concat(e)}:{}});if(!t.ok){let e=await t.json();throw Error(e.message||"HTTP ".concat(t.status))}let o=t.headers.get("content-type");if(null==o?void 0:o.includes("text/csv"))return await t.text();if(null==o||!o.includes("application/json"))return await t.json();{let e=await t.json();if(e.success&&e.data)return e.data;return e}}catch(e){throw console.error("Export Error:",e),e}},getPreview:async e=>c("/api/urls/preview/".concat(e),{skipAuth:!0}),bulkCreate:async e=>c("/api/urls/bulk",{method:"POST",body:e}),getById:async e=>c("/api/urls/".concat(e)),update:async(e,t)=>c("/api/urls/".concat(e),{method:"PUT",body:t}),delete:async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return c("/api/urls/".concat(e).concat(t?"?hardDelete=true":""),{method:"DELETE"})},generateQR:async(e,t)=>c("/api/urls/".concat(e,"/qr"),{method:"POST",body:t||{}}),getStats:async e=>c("/api/urls/".concat(e,"/stats"))},analytics:{getUrlAnalytics:async(e,t)=>{let a=new URLSearchParams;return t&&Object.entries(t).forEach(e=>{let[t,o]=e;null!=o&&a.append(t,String(o))}),c("/api/analytics/url/".concat(e).concat(a.toString()?"?".concat(a.toString()):""))},getDashboard:async e=>{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,o]=e;null!=o&&t.append(a,String(o))}),c("/api/analytics/dashboard".concat(t.toString()?"?".concat(t.toString()):""))},getPlatformAnalytics:async e=>{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,o]=e;null!=o&&t.append(a,String(o))}),c("/api/analytics/platform".concat(t.toString()?"?".concat(t.toString()):""))},getRealTime:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;return c("/api/analytics/realtime?minutes=".concat(e))},getClickAnalytics:async e=>{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,o]=e;null!=o&&t.append(a,String(o))}),c("/api/analytics/clicks".concat(t.toString()?"?".concat(t.toString()):""))},getTopContent:async e=>{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,o]=e;null!=o&&t.append(a,String(o))}),c("/api/analytics/top".concat(t.toString()?"?".concat(t.toString()):""))},getGeographicAnalytics:async e=>{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,o]=e;null!=o&&t.append(a,String(o))}),c("/api/analytics/geographic".concat(t.toString()?"?".concat(t.toString()):""))},generateReport:async e=>c("/api/analytics/report",{method:"POST",body:e}),getAnalyticsSummary:async e=>c("/api/analytics/summary",{method:"POST",body:e}),exportAnalytics:async e=>{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,o]=e;null!=o&&t.append(a,String(o))}),c("/api/analytics/export".concat(t.toString()?"?".concat(t.toString()):""))},cleanupAnalyticsData:async e=>c("/api/analytics/cleanup",{method:"POST",body:e||{}})},redirects:{getPreview:async e=>c("/preview/".concat(e),{skipAuth:!0}),handleQRRedirect:async e=>{window.location.href="".concat(n,"/qr/").concat(e)},validateBatch:async e=>c("/validate-batch",{method:"POST",body:{shortCodes:e},skipAuth:!0}),handleTrackedRedirect:async e=>{window.location.href="".concat(n,"/").concat(e,"/track")},getPublicStats:async e=>c("/".concat(e,"/stats"),{skipAuth:!0}),unlockPasswordProtected:async(e,t)=>c("/".concat(e,"/unlock"),{method:"POST",body:{password:t},skipAuth:!0}),handleRedirect:async e=>{window.location.href="".concat(n,"/").concat(e)}},utils:{copyToClipboard:async e=>{if(!navigator.clipboard)try{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();let a=document.execCommand("copy");return document.body.removeChild(t),a}catch(e){return console.error("Fallback copy failed:",e),!1}try{return await navigator.clipboard.writeText(e),!0}catch(e){return console.error("Copy to clipboard failed:",e),!1}}}}}}]);